$(function(){$.fn.googleMap=function(t){switch(t=$.extend({zoom:10,coords:[48.895651,2.290569],type:"ROADMAP",debug:!1,langage:"english",overviewMapControl:!1,streetViewControl:!1,scrollwheel:!1,mapTypeControl:!1},t),t.type){case"ROADMAP":case"SATELLITE":case"HYBRID":case"TERRAIN":t.type=google.maps.MapTypeId[t.type];break;default:t.type=google.maps.MapTypeId.ROADMAP}return this.each(function(){var e=new google.maps.Map(this,{zoom:t.zoom,center:new google.maps.LatLng(t.coords[0],t.coords[1]),mapTypeId:t.type,scrollwheel:t.scrollwheel,streetViewControl:t.streetViewControl,overviewMapControl:t.overviewMapControl,mapTypeControl:t.mapTypeControl});$(this).data("googleMap",e),$(this).data("googleLang",t.langage),$(this).data("googleDebug",t.debug),$(this).data("googleMarker",new Array),$(this).data("googleBound",new google.maps.LatLngBounds)}),this},$.fn.addMarker=function(t){return t=$.extend({coords:!1,address:!1,url:!1,id:!1,icon:!1,draggable:!1,title:"",text:"",success:function(){}},t),this.each(function(){if($this=$(this),!$this.data("googleMap"))return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker where there is no map !"),!1;if(!t.coords&&!t.address)return $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to add a marker if you don't tell us where !"),!1;if(t.address&&"string"==typeof t.address){(function(e){var i=new google.maps.Geocoder;i.geocode({address:t.address,bounds:e.data("googleBound"),language:e.data("googleLang")},function(i,s){if(s==google.maps.GeocoderStatus.OK){if(e.data("googleBound").extend(i[0].geometry.location),t.icon)var n=new google.maps.Marker({map:$this.data("googleMap"),position:i[0].geometry.location,title:t.title,icon:t.icon,draggable:t.draggable});else var n=new google.maps.Marker({map:e.data("googleMap"),position:i[0].geometry.location,title:t.title,draggable:t.draggable});if(t.draggable&&google.maps.event.addListener(n,"dragend",function(){var e=n.getPosition(),i={};i.lat=e.lat(),i.lon=e.lng(),t.success(i,$this)}),""==t.title||""==t.text||t.url)t.url&&google.maps.event.addListener(n,"click",function(){document.location=t.url});else{var o=new google.maps.InfoWindow({content:"<h1>"+t.title+"</h1>"+t.text}),a=e.data("googleMap");google.maps.event.addListener(n,"click",function(){o.open(a,n)})}t.id?e.data("googleMarker")[t.id]=n:e.data("googleMarker").push(n),1==e.data("googleMarker").length?(e.data("googleMap").setCenter(i[0].geometry.location),e.data("googleMap").setZoom(e.data("googleMap").getZoom())):e.data("googleMap").fitBounds(e.data("googleBound"));var r={};r.lat=i[0].geometry.location.lat(),r.lon=i[0].geometry.location.lng(),t.success(r,$this)}else $this.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the marker ("+s+")")})})($this)}else{if($this.data("googleBound").extend(new google.maps.LatLng(t.coords[0],t.coords[1])),t.icon)var i=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(t.coords[0],t.coords[1]),title:t.title,icon:t.icon,draggable:t.draggable});else var i=new google.maps.Marker({map:$this.data("googleMap"),position:new google.maps.LatLng(t.coords[0],t.coords[1]),title:t.title,draggable:t.draggable});if(""==t.title||""==t.text||t.url)t.url&&google.maps.event.addListener(i,"click",function(){document.location=t.url});else{var s=new google.maps.InfoWindow({content:"<h1>"+t.title+"</h1>"+t.text}),n=$this.data("googleMap");google.maps.event.addListener(i,"click",function(){s.open(n,i)})}t.draggable&&google.maps.event.addListener(i,"dragend",function(){var e=i.getPosition(),s={};s.lat=e.lat(),s.lon=e.lng(),t.success(s,$this)}),t.id?$this.data("googleMarker")[t.id]=i:$this.data("googleMarker").push(i),1==$this.data("googleMarker").length?($this.data("googleMap").setCenter(new google.maps.LatLng(t.coords[0],t.coords[1])),$this.data("googleMap").setZoom($this.data("googleMap").getZoom())):$this.data("googleMap").fitBounds($this.data("googleBound")),t.success({lat:t.coords[0],lon:t.coords[1]},$this)}}),this},$.fn.removeMarker=function(t){this.each(function(){var e=$(this);if(!e.data("googleMap"))return e.data("googleDebug")&&console.log("jQuery googleMap : Unable to delete a marker where there is no map !"),!1;var i=e.data("googleMarker");return"undefined"!=typeof i[t]?(i[t].setMap(null),e.data("googleDebug")&&console.log("jQuery googleMap : marker deleted"),!0):(e.data("googleDebug")&&console.error("jQuery googleMap : Unable to delete a marker if it not exists !"),!1)})},$.fn.addWay=function(t){t=$.extend({start:!1,end:!1,step:[],route:!1,langage:"english"},t);var e=new google.maps.DirectionsService({region:"fr"}),i=new google.maps.DirectionsRenderer({draggable:!0,map:$(this).data("googleMap"),panel:document.getElementById(t.route),provideTripAlternatives:!0});document.getElementById.innerHTML="";var s=[];for(var n in t.step){var o;o="object"==typeof t.step[n]?new google.maps.LatLng(t.step[n][0],t.step[n][1]):t.step[n],s.push({location:o,stopover:!0})}if("object"!=typeof t.end){(function(n){var o=new google.maps.Geocoder;o.geocode({address:t.end,bounds:n.data("googleBound"),language:t.langage},function(o,a){if(a==google.maps.GeocoderStatus.OK){var r={origin:t.start,destination:o[0].geometry.location,travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:s};e.route(r,function(t,e){e==google.maps.DirectionsStatus.OK?i.setDirections(t):n.data("googleDebug")&&console.error("jQuery googleMap : Unable to find the place asked for the route ("+t+")")})}else n.data("googleDebug")&&console.error("jQuery googleMap : Address not found")})})($(this))}else{var r={origin:t.start,destination:new google.maps.LatLng(t.end[0],t.end[1]),travelMode:google.maps.DirectionsTravelMode.DRIVING,region:"fr",waypoints:s};e.route(r,function(t,e){e==google.maps.DirectionsStatus.OK?i.setDirections(t):$(this).data("googleDebug")&&console.error("jQuery googleMap : Address not found")})}return this}});